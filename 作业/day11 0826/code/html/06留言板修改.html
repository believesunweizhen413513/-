<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>留言板</title>

    <link rel="stylesheet" href="../css/01留言板.css">
    <link rel="stylesheet" href="../css/base.css">
</head>

<body>
    <div id="box">
        <div class="top">
            <h2>显示5条最新消息</h2>
        </div>
        <div class="center">
            <h4>最新消息</h4>
            <div id="xiaoxi">
                <!-- <a href="">小明由于调戏女老师再次被滚出教室</a>
                <a href="">iPhone10发布亮瞎了所有小伙伴</a>
                <a href="">为了弘扬中华民族助人为乐的传统美德，中国人大开会</a> -->
            </div>
            <div class="bottom">
                <div class="left">
                    <input type="text" id="tex" placeholder="最新消息显示在顶部">
                </div>
                <div class="right">
                    <input type="button" id="btn" value="添加">
                </div>
            </div>
        </div>
    </div>
</body>
<script>

    /* 需求：
             1、根据数组的内容，动态生成li节点，渲染数据
             2、点击按钮可以获取内容生成节点
                 * 新节点从前面插入
                 * 数据只保留5条
 
     */
    (function () {
        // 获取焦点
        var xiaoxi = document.getElementById('xiaoxi');
        var btn = document.getElementById("btn");
        var tex = document.getElementById("tex");
        // 创建一个数组，存放消息内容
        var arr = ['小明由于调戏女老师再次被滚出教室', 'iPhone10发布亮瞎了所有小伙伴',
            '为了弘扬中华民族助人为乐的传统美德，中国人大开会'];
        // 获取数组信息返回一个长度相等的数组
        function show() {
            var html = arr.map(function (item) {
                return ` <a href="###">${item}</a> `;

            }).join('');
            xiaoxi.innerHTML = html;//渲染到页面
        }
        show();
        // 过滤敏感词
        function filter(str){
            var arr=["fuck", "妈蛋", "垃圾", '操'];
            arr.forEach(function(item){
                var reg=new RegExp(item,"gi");
                str=str.replace(reg,"***");
            })
            return str;
        }
        btn.onclick = function () {//点击的时候获取input的内容，渲染到数组开头
            var news = tex.value.trim();
            if (news) {////非空再创建节点
                var val = filter(news);//把输入的内容传给过滤敏感词的函数，过滤,重点
                arr.unshift(val);//过滤后的内容
                if (arr.length > 5) {//判断数组长度，大于5的时候删除最后一个
                    arr.pop();
                }
            } else {
                alert("请输入留言")
            }
            show();
        }
        tex.onfocus = function () {// 获取焦点，清空数据
            tex.value = "";
        }
        // document.onkeydown = function (ev){
        //     if(ev.keyCode==13){
        //         arr.unshift(val);
        //     }
        // }
    })();

</script>

</html>