<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>大小写字母和数字的组合，长度为4</title>
    <style>
        #yz {
            display: inline-block;
            width: 80px;
            height: 30px;
            line-height: 30px;
            border: 1px solid #ccc;
            text-align: center;
        }

        #stn {
            display: inline-block;
            width: 150px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            font-size: 16px;
        }

        span {
            padding: 3px;
        }
    </style>
</head>

<body>
    输入验证码:<input type="text" name="" id="num" style="height:24px;">
    <div id="yz">
    </div>
    <input type="button" value="看不清，换一张" id="stn">
    <input type="button" value="提交" id="btn">
    <span id="inf"></span>
</body>
<script>
    (function () {
        //找节点
        var num = document.getElementById('num');
        var rannum = document.getElementById('yz');
        var stn = document.getElementById('stn');
        var btn = document.getElementById('btn');
        var inf = document.getElementById('inf');
        var color = yz.getElementsByTagName("span");

        /*
                * 生成一个四位数带字母的随机数：封装函数：大小写字母和数字的组合，长度为4
                * 点击提交的时候：验证输入的数据是否和随机数一样，给出提示
        */
        function yanzheng(n) {
            var str = 'zxcvbnmlkjhgfdsaqwertyuiopZXCVBNMLKJHGFDSAQWERTYUIOP1234567890';//0 - lenght
            var html = '';
            for (var i = 0; i < n; i++) {
                var index = parseInt(Math.random() * str.length);//0 - str.length-1
                var r = parseInt(Math.random() * 90 - 45);
                var f = parseInt(Math.random() * 30 + 16);
                var num = '<span style="display:inline-block;transform:rotate(' + r + 'deg' + ');font-size="' + f + 'px' + '">' + str[index] + '</span>';
                html += num;
            }
            return html;//拼接好的四位随机数
        }

        //1.生成一个四位数随机数
        yz.innerHTML = yanzheng(4);//马上生成一个随机数放到表单
        function mc() {
            var str = "0123456789abcdef";
            var sum = '#';
            for (i = 0; i < 6; i++) {
                var cl = parseInt(Math.random() * str.length);
                var num = str[cl]
                sum += num;
            }
            return sum;
        }
        var img = new Array(4);
        img[0] = "../img/1.jpg";
        img[1] = "../img/2.jpg";
        img[2] = "../img/3.jpg";
        img[3] = "../img/4.jpg";
        Number = Math.floor(Math.random() * img.length);
        yz.style.backgroundImage = "url('../img/" + Number + ".jpg')";

        //一开始就改变字体颜色
        color[0].style.color = mc();
        color[1].style.color = mc();
        color[2].style.color = mc();
        color[3].style.color = mc();
        //2.点击一次，生成一个随机数替换yz的值
        // yz.style.background = mc();//一开始就生成背景颜色
        stn.onclick = function () {
            yz.innerHTML = yanzheng(4);
            yz.style.backgroundImage = "url('../img/" + Number + ".jpg')";
            // yz.style.background = mc();
            color[0].style.color = mc();
            color[1].style.color = mc();
            color[2].style.color = mc();
            color[3].style.color = mc();
            img[0] = "../img/1.jpg";
            img[1] = "../img/2.jpg";
            img[2] = "../img/3.jpg";
            img[3] = "../img/4.jpg";
            Number = Math.floor(Math.random() * img.length);
        }

        //3.点击提交的时候：验证输入的数据是否和随机数一样，给出提示
        btn.onclick = function () {
            var val1 = num.value;
            var val2 = yz.innerText;
            if (val1.toLowerCase() == val2.toLowerCase()) {//两个都转为小写，就不会区分大小写，比较方便
                alert('验证通过');
                inf.innerHTML = '验证通过';
                inf.style.color = '#58bc58';
            } else {
                inf.innerHTML = '验证不通过';
                inf.style.color = 'red';
            }
        }

    })();
</script>

</html>