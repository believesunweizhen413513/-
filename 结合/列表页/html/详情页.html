<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <title>Document</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../iconfont/demo.css">
    <link rel="stylesheet" href="../iconfont/iconfont.css">
    <link rel="stylesheet" href="../css/xiangqing.css">
</head>
<script src="../js/common.js"></script>

<body>

    <div id="detail_page">
        <div class="content">
            <div id="welcome">欢迎你访问我们的网站。<a href="###" class="quit">退出</a></div>
            <div class="top ">
                <div class="imageslist fl">
                    <div class="bigimg">
                        <!-- <img src="../images/1-1.webp">
                        <span id="lay"></span> -->
                    </div>
                    <div class="fd">
                        <img src="../images/1-1.webp">
                    </div>
                    <div class="smallimg">
                        <img src="../images/1-2.webp" alt="">
                        <img src="../images/1-3.webp" alt="">
                        <img src="../images/1-4.webp" alt="">
                    </div>
                    <div class="collect">
                        <i class="iconfont icon-xingzhuang60kaobei2"></i>
                        <span>收藏宝贝</span>
                        <em class="renqi">(343人气)</em>
                    </div>
                </div>
                <div class="information fl">
                    <div class="pruduct_name">
                        <p>
                            2019秋装韩版收腰显瘦小香风长袖a字针织连衣裙
                        </p>
                    </div>
                    <div class="brand_title">
                        <img src="../images/111.png" alt="">
                        <span>海量新品</span>
                        <span>潮流穿搭</span>
                        <span>玩趣互动</span>
                    </div>
                    <div class="price">
                        <div class="price_left">
                            <div class="oldprice">
                                <span>价格</span>
                                <i>&yen;</i>
                                <em>288.00</em>
                            </div>
                            <div class="newprice">
                                <span>淘宝价</span>
                                <i>&yen;</i>
                                <em>148.00</em>
                                <span>新品促销</span>
                            </div>
                        </div>
                        <div class="price_right">
                            <div class="comment">
                                <i>36</i>
                                <span>累计评论</span>
                            </div>
                            <div class=" transaction">
                                <i>109</i>
                                <span>交易成功</span>
                            </div>
                        </div>
                    </div>
                    <div class="discounts">
                        <span class="youhui">优惠</span>
                        <div class="discount_coupon">
                            <div class="tao">
                                淘金币可抵<strong>2.96</strong>元
                            </div>
                            <div class="quan">
                                <img src="../images/优惠券.png" alt="">
                                <span>50元店铺优惠券，满51元可用</span>
                                <a href="###">领取</a>
                            </div>
                        </div>
                    </div>
                    <div class="dispatching">
                        <span class="_text">配送</span>
                        <div class="_addres">
                            <span>广东广州</span>
                            <span class="zhi">至</span>
                            <select name="" id="">
                                <option value="">广西南宁</option>
                            </select>
                            <select name="" id="">
                                <option value="">快递 免运费</option>
                            </select>
                            <span>45天内发货</span>
                        </div>
                    </div>
                    <div class="hepler">
                        尺寸助手
                    </div>
                    <div class="choose">
                        <dl class="size">
                            <dt>尺码</dt>
                            <dd>
                                <ul>
                                    <li><a href="###" title="该码为中国码">S</a></li>
                                    <li><a href="###" title="该码为中国码">M</a></li>
                                    <li><a href="###" title="该码为中国码">L</a></li>
                                </ul>
                            </dd>
                        </dl>
                        <dl class="color">
                            <dt>颜色分类</dt>
                            <dd>
                                <ul class="imglist2">
                                    <li><img src="../images/4-1.webp" title="黑色"></li>
                                    <li><img src="../images/4-2.webp" title="白色"></li>
                                </ul>
                            </dd>
                        </dl>
                        <dl class="count">
                            <dt>数量</dt>
                            <dd>
                                <div class="choose_count">
                                    <span class="decress">-</span>
                                    <input class="buy_count" type="text" placeholder="1">
                                    <span class="plus">+</span>
                                </div>
                                <span class="kucun">件（库存2585件）</span>
                            </dd>
                        </dl>
                        <dl class="payment">
                            <dt>花呗分期</dt>
                            <dd>
                                <ul>
                                    <li>
                                        <a href="###" class="">
                                            <p class="price1">&yen; 91.98x3期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="###">
                                            <p class="price2">&yen; 91.98x6期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="###">
                                            <p class="price3">&yen; 91.98x12期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                </ul>
                            </dd>
                        </dl>
                        <div class="buy_sure">
                            <a href="###" class="buy_btn">立刻购买</a>
                            <a href="###" class="goods_car">加入购物车</a>
                        </div>
                        <div class="honest">
                            <dl>
                                <dt>承诺</dt>
                                <dd>
                                    <ul>
                                        <li>
                                            <img src="../images/icon7天.jpg" alt="">
                                            <span>7天无理由</span>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>支付</dt>
                                <dd>
                                    <ul>
                                        <li>
                                            <img src="../images/icon花呗.png" alt="">
                                            <span>蚂蚁花呗</span>
                                        </li>
                                        <li>
                                            <img src="../images/icon信用卡.png" alt="">
                                            <span>信用卡支付</span>
                                        </li>
                                        <li>
                                            <img src="../images/iocn积分宝.png" alt="">
                                            <span>集分包</span>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                    </div>

                </div>

            </div>
            <div class="bottom">
                <ul id="ul">
                    <li>宝贝详情</li>
                    <li>
                        累计评论
                        <i>92</i>
                    </li>
                    <li>专享服务</li>
                </ul>
                <div class="sha" style="display: block">1</div>
                <div class="sha">2</div>
                <div class="sha">3</div>
            </div>
        </div>
    </div>
</body>
<script>
    (() => {
        let welcome = document.getElementById('welcome');
        function update() {
            let user = getCookie('username');
            if (user) {
                welcome.innerHTML = `${user},欢迎你访问我们的网站。<a href="###" class="quit">退出</a>`
            } else {
                welcome.innerHTML = `欢迎你访问我们的网站。<a href="###" class="quit">登录</a>`
            }
        };
        update();
        welcome.onclick = function (ev) {
            ev = ev || window.event;
            // 退出
            if (ev.target.innerHTML == '退出') {
                alert('退出成功');
                removeCookie('username');
                removeCookie('url');
            } else if (ev.target.innerHTML == '登录') {
                location.href = '登录页.html';
                setCookie('url', location.href, 7);//记录路径，点击登录再跳转回来
            }
            update();//重新渲染
        }
        let detailPage = document.getElementById('detail_page');
        let ids = decodeURI(location.search).split('?')[1];
        let top = document.getElementsByClassName('top')[0];
        function init() {
            ajax({
                type: 'post',
                url: '../api/list.php',
                data: {
                    ids,
                },
                success: str => {
                    create(str);
                }
            });
            function create(str) {
                let arr = JSON.parse(str);
                let html = arr.map(function (item) {
                    let arr2 = item.url.split(',');
                    let imgs = arr2.map(function (item) {
                        return `<li><img src="${item}"></li>`
                    }).join('');
                    return ` 
                <div class="imageslist fl">
                    <div class="bigimg">
                        <img src="${item.url}">
                        <span id="lay"></span>
                    </div>
                    <div class="fd">
                        <img src="../images/1-1.webp">
                    </div>
                    <ul class="smallimg">
                       ${imgs}
                    </ul>
                    <div class="collect">
                        <i class="iconfont icon-xingzhuang60kaobei2"></i>
                        <span>收藏宝贝</span>
                        <em class="renqi">(${item.renqi}人气)</em>
                    </div>
                </div>
                <div class="information fl">
                    <div class="pruduct_name">
                        <p>
                            ${item.title}
                        </p>
                    </div>
                    <div class="brand_title">
                        <img src="../images/111.png" alt="">
                        <span>海量新品</span>
                        <span>潮流穿搭</span>
                        <span>玩趣互动</span>
                    </div>
                    <div class="price">
                        <div class="price_left">
                            <div class="oldprice">
                                <span>价格</span>
                                <i>&yen;</i>
                                <em>${item.oldprice}</em>
                            </div>
                            <div class="newprice">
                                <span>淘宝价</span>
                                <i>&yen;</i>
                                <em>${item.price}</em>
                                <span>新品促销</span>
                            </div>
                        </div>
                        <div class="price_right">
                            <div class="comment">
                                <i>${item.pinglun}</i>
                                <span>累计评论</span>
                            </div>
                            <div class=" transaction">
                                <i>${item.paypeople}</i>
                                <span>交易成功</span>
                            </div>
                        </div>
                    </div>
                    <div class="discounts">
                        <span class="youhui">优惠</span>
                        <div class="discount_coupon">
                            <div class="tao">
                                淘金币可抵<strong>2.96</strong>元
                            </div>
                            <div class="quan">
                                <img src="../images/优惠券.png" alt="">
                                <span>50元店铺优惠券，满51元可用</span>
                                <a href="###">领取</a>
                            </div>
                        </div>
                    </div>
                    <div class="dispatching">
                        <span class="_text">配送</span>
                        <div class="_addres">
                            <span>广东广州</span>
                            <span class="zhi">至</span>
                            <select name="" id="">
                                <option value="">广西南宁</option>
                            </select>
                            <select name="" id="">
                                <option value="">快递 免运费</option>
                            </select>
                            <span>45天内发货</span>
                        </div>
                    </div>
                    <div class="hepler">
                        尺寸助手
                    </div>
                    <div class="choose">
                        <dl class="size">
                            <dt>尺码</dt>
                            <dd>
                                <ul>
                                    <li><a href="###" title="该码为中国码">S</a></li>
                                    <li><a href="###" title="该码为中国码">M</a></li>
                                    <li><a href="###" title="该码为中国码">L</a></li>
                                </ul>
                            </dd>
                        </dl>
                        <dl class="color">
                            <dt>颜色分类</dt>
                            <dd>
                                <ul class="imglist2">
                                   ${imgs}
                                </ul>
                            </dd>
                        </dl>
                        <dl class="count">
                            <dt>数量</dt>
                            <dd>
                                <div class="choose_count">
                                    <span class="decress">-</span>
                                    <input class="buy_count" type="text" value="1">
                                    <span class="plus">+</span>
                                </div>
                                <span class="kucun">件（库存2585件）</span>
                            </dd>
                        </dl>
                        <dl class="payment">
                            <dt>花呗分期</dt>
                            <dd>
                                <ul>
                                    <li>
                                        <a href="###" class="">
                                            <p class="price1">&yen; 91.98x3期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="###">
                                            <p class="price2">&yen; 91.98x6期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="###">
                                            <p class="price3">&yen; 91.98x12期</p>
                                            <p>(含手续费)</p>
                                        </a>
                                    </li>
                                </ul>
                            </dd>
                        </dl>
                        <div class="buy_sure">
                            <a href="###" class="buy_btn">立刻购买</a>
                            <a href="###" class="goods_car">加入购物车</a>
                        </div>
                        <div class="honest">
                            <dl>
                                <dt>承诺</dt>
                                <dd>
                                    <ul>
                                        <li>
                                            <img src="../images/icon7天.jpg" alt="">
                                            <span>7天无理由</span>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>支付</dt>
                                <dd>
                                    <ul>
                                        <li>
                                            <img src="../images/icon花呗.png" alt="">
                                            <span>蚂蚁花呗</span>
                                        </li>
                                        <li>
                                            <img src="../images/icon信用卡.png" alt="">
                                            <span>信用卡支付</span>
                                        </li>
                                        <li>
                                            <img src="../images/iocn积分宝.png" alt="">
                                            <span>集分包</span>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                    </div>

                </div>

           `
                }).join('');
                top.innerHTML = html;
                let goodsCarBtn = document.getElementsByClassName('goods_car')[0];
                let buyCount = document.getElementsByClassName('buy_count')[0];
                goodsCarBtn.onclick = () => {
                    let user = getCookie('username');
                    let count = buyCount.value.trim();
                    ajax({
                        type: 'post',
                        url: '../api/addTogoodsCar.php',
                        data: {
                            'gid': ids,//商品id
                            'username': user,//用户名
                            'count': count,//购买数量
                        },
                        success: str => {
                            console.log(str);
                        },
                    });
                    window.open('购物车.html?');

                }
            }
        }
        init();


    })();

</script>

</html>